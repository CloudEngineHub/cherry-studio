# Terminal Implementation Guide for Electron Applications

<!-- This doc is generated by claude code. -->

Âü∫‰∫é VS Code ÁªàÁ´ØÂäüËÉΩÂàÜÊûêÂèäÁÆÄÂåñÂÆûÁé∞ÊñπÊ°à

## Ê¶ÇËø∞

Êú¨ÊñáÊ°£ÂàÜÊûê‰∫Ü VS Code ÁöÑÁªàÁ´ØÂÆûÁé∞ÂéüÁêÜÔºåÂπ∂Êèê‰æõ‰∫Ü‰∏§ÁßçÂÆûÁé∞ÊñπÊ°àÔºö
1. **Á∫Ø JavaScript ÊñπÊ°à**ÔºàÊé®ËçêÔºâ- Êó†ÈúÄÊú¨Âú∞ÁºñËØëÁéØÂ¢ÉÔºåÂü∫‰∫é child_process
2. **node-pty ÊñπÊ°à** - ÂäüËÉΩÊõ¥ÂÆåÊï¥‰ΩÜÈúÄË¶ÅÊú¨Âú∞ÁºñËØëÁéØÂ¢É

## VS Code Terminal ÊäÄÊúØÊ†àÂàÜÊûê

### Ê†∏ÂøÉÁªÑ‰ª∂

1. **xterm.js** - ÂâçÁ´ØÁªàÁ´ØÊ®°ÊãüÂô®ÔºàTypeScriptÁºñÂÜôÔºâ
2. **node-pty** - ÂêéÁ´Ø‰º™ÁªàÁ´ØÂ§ÑÁêÜ
3. **ConPTY/winpty** - WindowsÁ≥ªÁªüÂÖºÂÆπÂ±Ç

### Êû∂ÊûÑËÆæËÆ°

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Renderer      ‚îÇ    ‚îÇ    Main      ‚îÇ    ‚îÇ   System    ‚îÇ
‚îÇ   (xterm.js)    ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  (node-pty)  ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   Shell     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

VS Code ÁöÑÁªàÁ´ØÂäüËÉΩ‰∏ªË¶ÅÁâπÁÇπÔºö

- **Ë∑®Âπ≥Âè∞ÂÖºÂÆπÊÄß**: Windows 10+ ‰ΩøÁî® ConPTY APIÔºåÊóßÁâàÊú¨ÂõûÈÄÄÂà∞ winpty
- **È´òÊÄßËÉΩ**: xterm.js ÁªèËøáÈ´òÂ∫¶‰ºòÂåñÔºåËÉΩÂ§üÂ§ÑÁêÜÂ§ßÈáèËæìÂá∫
- **‰∏∞ÂØåÂäüËÉΩ**: ÊîØÊåÅ‰∏ªÈ¢ò„ÄÅÂ≠ó‰ΩìÂÆöÂà∂„ÄÅÊêúÁ¥¢„ÄÅÈìæÊé•ËØÜÂà´Á≠â

## ÊñπÊ°à‰∏ÄÔºöÁ∫Ø JavaScript ÂÆûÁé∞ÔºàÊé®ËçêÔºâ

### ÁéØÂ¢ÉË¶ÅÊ±Ç

- Node.js 12+ Êàñ Electron 8+
- **Êó†ÈúÄ‰ªª‰ΩïÊú¨Âú∞ÁºñËØëÁéØÂ¢É**

### 1. ‰æùËµñÂÆâË£Ö

```bash
npm install xterm @xterm/addon-fit
# ‰∏çÈúÄË¶Å node-ptyÔºÅ
```

### 2. ‰∏ªËøõÁ®ãÂÆûÁé∞ (main.js) - Á∫Ø JavaScript ÁâàÊú¨

```javascript
const { app, BrowserWindow, ipcMain } = require('electron');
const { spawn } = require('child_process');
const path = require('path');
const os = require('os');

let mainWindow;
let shellProcess;

function createWindow() {
  mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
      preload: path.join(__dirname, 'preload.js')
    }
  });

  mainWindow.loadFile('index.html');
}

// Ëé∑ÂèñÁ≥ªÁªüÈªòËÆ§ shell
function getDefaultShell() {
  if (process.platform === 'win32') {
    return process.env.COMSPEC || 'cmd.exe';
  } else {
    return process.env.SHELL || '/bin/bash';
  }
}

// ÂàõÂª∫ shell ËøõÁ®ã
ipcMain.handle('terminal-create', () => {
  try {
    const shell = getDefaultShell();
    const args = process.platform === 'win32' ? [] : ['-i']; // interactive mode for unix

    shellProcess = spawn(shell, args, {
      cwd: os.homedir(),
      env: { ...process.env, TERM: 'xterm-256color' },
      stdio: 'pipe'
    });

    // ÁõëÂê¨Ê†áÂáÜËæìÂá∫
    shellProcess.stdout.on('data', (data) => {
      mainWindow.webContents.send('terminal-data', data.toString());
    });

    // ÁõëÂê¨ÈîôËØØËæìÂá∫
    shellProcess.stderr.on('data', (data) => {
      mainWindow.webContents.send('terminal-data', data.toString());
    });

    // ÁõëÂê¨ËøõÁ®ãÈÄÄÂá∫
    shellProcess.on('exit', (code) => {
      mainWindow.webContents.send('terminal-exit', code);
      shellProcess = null;
    });

    // ÁõëÂê¨ËøõÁ®ãÈîôËØØ
    shellProcess.on('error', (error) => {
      mainWindow.webContents.send('terminal-error', error.message);
    });

    return { success: true };
  } catch (error) {
    return { success: false, error: error.message };
  }
});

// Âêë shell ÂÜôÂÖ•ÂëΩ‰ª§
ipcMain.handle('terminal-write', (event, data) => {
  if (shellProcess && shellProcess.stdin) {
    shellProcess.stdin.write(data);
  }
});

// ÁªàÁ´ØÊ∏ÖÂ±èÔºàÂèëÈÄÅ clear ÂëΩ‰ª§Ôºâ
ipcMain.handle('terminal-clear', () => {
  if (shellProcess && shellProcess.stdin) {
    const clearCommand = process.platform === 'win32' ? 'cls\r\n' : 'clear\r\n';
    shellProcess.stdin.write(clearCommand);
  }
});

// ÁªàÊ≠¢ËøõÁ®ã
ipcMain.handle('terminal-kill', () => {
  if (shellProcess) {
    if (process.platform === 'win32') {
      // Windows ‰ΩøÁî® taskkill Âº∫Âà∂ÁªàÊ≠¢
      spawn('taskkill', ['/pid', shellProcess.pid, '/f', '/t']);
    } else {
      // Unix-like Á≥ªÁªüÂèëÈÄÅ SIGTERM
      shellProcess.kill('SIGTERM');
    }
    shellProcess = null;
  }
});

// ÂèëÈÄÅ Ctrl+C ‰ø°Âè∑
ipcMain.handle('terminal-interrupt', () => {
  if (shellProcess) {
    if (process.platform === 'win32') {
      // Windows ÂèëÈÄÅ Ctrl+C
      shellProcess.stdin.write('\x03');
    } else {
      // Unix-like Á≥ªÁªüÂèëÈÄÅ SIGINT
      shellProcess.kill('SIGINT');
    }
  }
});

app.whenReady().then(createWindow);

app.on('before-quit', () => {
  if (shellProcess) {
    shellProcess.kill();
  }
});
```

### 3. È¢ÑÂä†ËΩΩËÑöÊú¨ (preload.js) - Á∫Ø JavaScript ÁâàÊú¨

```javascript
const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('electronAPI', {
  terminal: {
    create: () => ipcRenderer.invoke('terminal-create'),
    write: (data) => ipcRenderer.invoke('terminal-write', data),
    clear: () => ipcRenderer.invoke('terminal-clear'),
    kill: () => ipcRenderer.invoke('terminal-kill'),
    interrupt: () => ipcRenderer.invoke('terminal-interrupt'),
    onData: (callback) => ipcRenderer.on('terminal-data', callback),
    onExit: (callback) => ipcRenderer.on('terminal-exit', callback),
    onError: (callback) => ipcRenderer.on('terminal-error', callback)
  }
});
```

### 4. Ê∏≤ÊüìËøõÁ®ãÂÆûÁé∞ (renderer.js) - Á∫Ø JavaScript ÁâàÊú¨

```javascript
import { Terminal } from 'xterm';
import { FitAddon } from '@xterm/addon-fit';
import { WebLinksAddon } from '@xterm/addon-web-links';

class PureJSTerminal {
  constructor(containerId) {
    this.terminal = new Terminal({
      theme: {
        background: '#1a1a1a',
        foreground: '#ffffff',
        cursor: '#ffffff',
        cursorAccent: '#000000',
        selection: 'rgba(255, 255, 255, 0.3)',
        black: '#000000',
        red: '#e74c3c',
        green: '#2ecc71',
        yellow: '#f39c12',
        blue: '#3498db',
        magenta: '#9b59b6',
        cyan: '#1abc9c',
        white: '#ecf0f1',
        brightBlack: '#34495e',
        brightRed: '#c0392b',
        brightGreen: '#27ae60',
        brightYellow: '#e67e22',
        brightBlue: '#2980b9',
        brightMagenta: '#8e44ad',
        brightCyan: '#16a085',
        brightWhite: '#bdc3c7'
      },
      fontSize: 14,
      fontFamily: '"Cascadia Code", "Fira Code", Monaco, Menlo, "Ubuntu Mono", monospace',
      fontWeight: 'normal',
      fontWeightBold: 'bold',
      cursorBlink: true,
      cursorStyle: 'block',
      scrollback: 1000,
      tabStopWidth: 4
    });

    this.fitAddon = new FitAddon();
    this.webLinksAddon = new WebLinksAddon();

    this.terminal.loadAddon(this.fitAddon);
    this.terminal.loadAddon(this.webLinksAddon);

    this.container = document.getElementById(containerId);
    this.isConnected = false;
    this.currentCommand = '';

    this.init();
  }

  async init() {
    try {
      this.terminal.open(this.container);
      this.fitAddon.fit();

      // ÊòæÁ§∫Ê¨¢Ëøé‰ø°ÊÅØ
      this.terminal.writeln('\x1b[33müñ•Ô∏è  Pure JavaScript Terminal\x1b[0m');
      this.terminal.writeln('\x1b[90mConnecting to shell...\x1b[0m');

      const result = await window.electronAPI.terminal.create();
      if (result.success) {
        this.isConnected = true;
        this.setupEventListeners();
        this.terminal.writeln('\x1b[32m‚úì Connected!\x1b[0m');
        this.terminal.focus();
      } else {
        this.terminal.writeln(`\x1b[31m‚úó Failed to connect: ${result.error}\x1b[0m`);
      }
    } catch (error) {
      this.terminal.writeln(`\x1b[31m‚úó Error: ${error.message}\x1b[0m`);
    }
  }

  setupEventListeners() {
    // Áî®Êà∑ËæìÂÖ•Â§ÑÁêÜ
    this.terminal.onData(data => {
      if (!this.isConnected) return;

      // Â§ÑÁêÜÁâπÊÆäÊåâÈîÆ
      if (data === '\r') { // Enter
        this.currentCommand = '';
        window.electronAPI.terminal.write('\r\n');
      } else if (data === '\u007F') { // Backspace
        window.electronAPI.terminal.write('\b \b');
      } else if (data === '\u0003') { // Ctrl+C
        window.electronAPI.terminal.interrupt();
      } else {
        this.currentCommand += data;
        window.electronAPI.terminal.write(data);
      }
    });

    // Êé•Êî∂ËæìÂá∫Êï∞ÊçÆ
    window.electronAPI.terminal.onData((event, data) => {
      // Â§ÑÁêÜ ANSI ËΩ¨‰πâÂ∫èÂàóÂíåÁâπÊÆäÂ≠óÁ¨¶
      this.terminal.write(data);
    });

    // Â§ÑÁêÜËøõÁ®ãÈÄÄÂá∫
    window.electronAPI.terminal.onExit((event, code) => {
      this.isConnected = false;
      this.terminal.writeln(`\r\n\x1b[33mProcess exited with code ${code}\x1b[0m`);
      this.terminal.writeln('\x1b[90mPress any key to restart...\x1b[0m');

      // ÂÖÅËÆ∏ÈáçÊñ∞ÂêØÂä®
      this.terminal.onData(() => {
        this.init();
      });
    });

    // Â§ÑÁêÜÈîôËØØ
    window.electronAPI.terminal.onError((event, error) => {
      this.terminal.writeln(`\r\n\x1b[31mError: ${error}\x1b[0m`);
    });

    // Á™óÂè£Â§ßÂ∞èË∞ÉÊï¥
    const resizeObserver = new ResizeObserver(() => {
      this.fitAddon.fit();
    });
    resizeObserver.observe(this.container);

    // ÈîÆÁõòÂø´Êç∑ÈîÆ
    this.terminal.attachCustomKeyEventHandler((event) => {
      // Ctrl+C - ‰∏≠Êñ≠ÂΩìÂâçÂëΩ‰ª§
      if (event.ctrlKey && event.code === 'KeyC' && event.type === 'keydown') {
        if (!this.terminal.hasSelection()) {
          window.electronAPI.terminal.interrupt();
          return false;
        }
        // Â¶ÇÊûúÊúâÈÄâ‰∏≠ÊñáÊú¨ÔºåÂàôÂ§çÂà∂
        document.execCommand('copy');
        return false;
      }

      // Ctrl+V - Á≤òË¥¥
      if (event.ctrlKey && event.code === 'KeyV' && event.type === 'keydown') {
        navigator.clipboard.readText().then(text => {
          if (this.isConnected) {
            window.electronAPI.terminal.write(text);
          }
        });
        return false;
      }

      // Ctrl+L - Ê∏ÖÂ±è
      if (event.ctrlKey && event.code === 'KeyL' && event.type === 'keydown') {
        this.clear();
        return false;
      }

      return true;
    });
  }

  clear() {
    if (this.isConnected) {
      window.electronAPI.terminal.clear();
    }
  }

  focus() {
    this.terminal.focus();
  }

  write(text) {
    this.terminal.write(text);
  }

  dispose() {
    if (this.isConnected) {
      window.electronAPI.terminal.kill();
    }
    this.terminal.dispose();
  }
}

// ÂØºÂá∫ÁªôÂÖ®Â±Ä‰ΩøÁî®
window.PureJSTerminal = PureJSTerminal;

document.addEventListener('DOMContentLoaded', () => {
  window.terminal = new PureJSTerminal('terminal-container');
});
```

### 5. ÊûÑÂª∫ÈÖçÁΩÆ (package.json) - Á∫Ø JavaScript ÁâàÊú¨

```json
{
  "name": "pure-js-terminal",
  "version": "1.0.0",
  "description": "Pure JavaScript terminal implementation with xterm.js",
  "main": "main.js",
  "scripts": {
    "start": "electron .",
    "build": "electron-builder",
    "dev": "electron . --development"
  },
  "dependencies": {
    "electron": "^22.0.0",
    "xterm": "^5.1.0",
    "@xterm/addon-fit": "^0.7.0",
    "@xterm/addon-web-links": "^0.8.0"
  },
  "devDependencies": {
    "electron-builder": "^24.0.0"
  },
  "build": {
    "appId": "com.example.pure-js-terminal",
    "productName": "Pure JS Terminal",
    "directories": {
      "output": "dist"
    }
  }
}
```

---

## ÊñπÊ°à‰∫åÔºönode-pty ÂÆûÁé∞ÔºàÈúÄË¶ÅÁºñËØëÁéØÂ¢ÉÔºâ

### ÁéØÂ¢ÉË¶ÅÊ±Ç

- Node.js 12+ Êàñ Electron 8+
- Python Âíå C++ ÁºñËØëÂô®ÔºàÁî®‰∫é node-pty ÁºñËØëÔºâ

### 1. ‰æùËµñÂÆâË£Ö

```bash
npm install xterm @xterm/addon-fit node-pty
```

### 2. ‰∏ªËøõÁ®ãÂÆûÁé∞ (main.js)

```javascript
const { app, BrowserWindow, ipcMain } = require('electron');
const pty = require('node-pty');
const path = require('path');

let mainWindow;
let ptyProcess;

function createWindow() {
  mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
      preload: path.join(__dirname, 'preload.js')
    }
  });

  mainWindow.loadFile('index.html');
}

// ÂàõÂª∫ÁªàÁ´ØËøõÁ®ã
ipcMain.handle('terminal-create', () => {
  const shell = process.platform === 'win32' ? 'powershell.exe' : 'bash';

  ptyProcess = pty.spawn(shell, [], {
    name: 'xterm-color',
    cols: 80,
    rows: 24,
    cwd: process.env.HOME,
    env: process.env
  });

  // ÁõëÂê¨ÁªàÁ´ØÊï∞ÊçÆËæìÂá∫
  ptyProcess.on('data', (data) => {
    mainWindow.webContents.send('terminal-data', data);
  });

  // ÁõëÂê¨ËøõÁ®ãÈÄÄÂá∫
  ptyProcess.on('exit', (code) => {
    mainWindow.webContents.send('terminal-exit', code);
  });

  return { success: true };
});

// ÂêëÁªàÁ´ØÂÜôÂÖ•Êï∞ÊçÆ
ipcMain.handle('terminal-write', (event, data) => {
  if (ptyProcess) {
    ptyProcess.write(data);
  }
});

// Ë∞ÉÊï¥ÁªàÁ´ØÂ§ßÂ∞è
ipcMain.handle('terminal-resize', (event, cols, rows) => {
  if (ptyProcess) {
    ptyProcess.resize(cols, rows);
  }
});

// ÁªàÁ´ØÊ∏ÖÂ±è
ipcMain.handle('terminal-clear', () => {
  if (ptyProcess) {
    ptyProcess.write('\x1bc'); // ÂèëÈÄÅÊ∏ÖÂ±èÂëΩ‰ª§
  }
});

// ÂÖ≥Èó≠ÁªàÁ´Ø
ipcMain.handle('terminal-kill', () => {
  if (ptyProcess) {
    ptyProcess.kill();
    ptyProcess = null;
  }
});

app.whenReady().then(createWindow);

app.on('before-quit', () => {
  if (ptyProcess) {
    ptyProcess.kill();
  }
});
```

### 3. È¢ÑÂä†ËΩΩËÑöÊú¨ (preload.js)

```javascript
const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('electronAPI', {
  terminal: {
    create: () => ipcRenderer.invoke('terminal-create'),
    write: (data) => ipcRenderer.invoke('terminal-write', data),
    resize: (cols, rows) => ipcRenderer.invoke('terminal-resize', cols, rows),
    clear: () => ipcRenderer.invoke('terminal-clear'),
    kill: () => ipcRenderer.invoke('terminal-kill'),
    onData: (callback) => ipcRenderer.on('terminal-data', callback),
    onExit: (callback) => ipcRenderer.on('terminal-exit', callback)
  }
});
```

### 4. Ê∏≤ÊüìËøõÁ®ãÂÆûÁé∞ (renderer.js)

```javascript
import { Terminal } from 'xterm';
import { FitAddon } from '@xterm/addon-fit';
import { WebLinksAddon } from '@xterm/addon-web-links';
import { SearchAddon } from '@xterm/addon-search';

class SimpleTerminal {
  constructor(containerId) {
    this.terminal = new Terminal({
      theme: {
        background: '#1e1e1e',
        foreground: '#cccccc',
        cursor: '#ffffff',
        selection: 'rgba(255, 255, 255, 0.3)',
        black: '#000000',
        red: '#cd3131',
        green: '#0dbc79',
        yellow: '#e5e510',
        blue: '#2472c8',
        magenta: '#bc3fbc',
        cyan: '#11a8cd',
        white: '#e5e5e5',
        brightBlack: '#666666',
        brightRed: '#f14c4c',
        brightGreen: '#23d18b',
        brightYellow: '#f5f543',
        brightBlue: '#3b8eea',
        brightMagenta: '#d670d6',
        brightCyan: '#29b8db',
        brightWhite: '#ffffff',
      },
      fontSize: 14,
      fontFamily: 'Monaco, Menlo, "Ubuntu Mono", Consolas, "Courier New", monospace',
      fontWeight: 'normal',
      fontWeightBold: 'bold',
      lineHeight: 1.2,
      cursorBlink: true,
      cursorStyle: 'block',
      scrollback: 1000,
      tabStopWidth: 4,
      bellStyle: 'none'
    });

    // Âä†ËΩΩÊèí‰ª∂
    this.fitAddon = new FitAddon();
    this.webLinksAddon = new WebLinksAddon();
    this.searchAddon = new SearchAddon();

    this.terminal.loadAddon(this.fitAddon);
    this.terminal.loadAddon(this.webLinksAddon);
    this.terminal.loadAddon(this.searchAddon);

    this.container = document.getElementById(containerId);
    this.isConnected = false;

    this.init();
  }

  async init() {
    try {
      // ÊåÇËΩΩÁªàÁ´ØÂà∞ DOM
      this.terminal.open(this.container);
      this.fitAddon.fit();

      // ÂàõÂª∫ÂêéÁ´ØÁªàÁ´ØËøõÁ®ã
      const result = await window.electronAPI.terminal.create();
      if (result.success) {
        this.isConnected = true;
        this.setupEventListeners();
        this.terminal.focus();
      }
    } catch (error) {
      console.error('Terminal initialization failed:', error);
      this.terminal.write('\r\n\x1b[31mError: Failed to initialize terminal\x1b[0m\r\n');
    }
  }

  setupEventListeners() {
    // ÁõëÂê¨Áî®Êà∑ËæìÂÖ•
    this.terminal.onData(data => {
      if (this.isConnected) {
        window.electronAPI.terminal.write(data);
      }
    });

    // ÁõëÂê¨ÂêéÁ´ØÊï∞ÊçÆËæìÂá∫
    window.electronAPI.terminal.onData((event, data) => {
      this.terminal.write(data);
    });

    // ÁõëÂê¨ËøõÁ®ãÈÄÄÂá∫
    window.electronAPI.terminal.onExit((event, code) => {
      this.isConnected = false;
      this.terminal.write(`\r\n\x1b[33mProcess exited with code ${code}\x1b[0m\r\n`);
    });

    // ÁõëÂê¨Á™óÂè£Â§ßÂ∞èÂèòÂåñ
    const resizeObserver = new ResizeObserver(() => {
      this.fitAddon.fit();
      if (this.isConnected) {
        const { cols, rows } = this.terminal;
        window.electronAPI.terminal.resize(cols, rows);
      }
    });

    resizeObserver.observe(this.container);

    // ÁõëÂê¨ÈîÆÁõòÂø´Êç∑ÈîÆ
    this.terminal.attachCustomKeyEventHandler((event) => {
      // Ctrl+C Â§çÂà∂ÈÄâ‰∏≠ÂÜÖÂÆπ
      if (event.ctrlKey && event.code === 'KeyC' && event.type === 'keydown') {
        const selection = this.terminal.getSelection();
        if (selection) {
          navigator.clipboard.writeText(selection);
          return false;
        }
      }

      // Ctrl+V Á≤òË¥¥
      if (event.ctrlKey && event.code === 'KeyV' && event.type === 'keydown') {
        navigator.clipboard.readText().then(text => {
          if (this.isConnected) {
            window.electronAPI.terminal.write(text);
          }
        });
        return false;
      }

      // Ctrl+L Ê∏ÖÂ±è
      if (event.ctrlKey && event.code === 'KeyL' && event.type === 'keydown') {
        this.clear();
        return false;
      }

      return true;
    });

    // Èº†Ê†áÊªöËΩÆÁº©Êîæ
    this.terminal.attachCustomWheelEventHandler((event) => {
      if (event.ctrlKey) {
        event.preventDefault();
        const delta = event.deltaY < 0 ? 1 : -1;
        const newSize = Math.max(8, Math.min(24, this.terminal.options.fontSize + delta));
        this.terminal.options.fontSize = newSize;
        this.fitAddon.fit();
        return false;
      }
      return true;
    });
  }

  // Ê∏ÖÂ±è
  clear() {
    if (this.isConnected) {
      window.electronAPI.terminal.clear();
    }
  }

  // ËÅöÁÑ¶ÁªàÁ´Ø
  focus() {
    this.terminal.focus();
  }

  // ÊêúÁ¥¢ÊñáÊú¨
  search(text, options = {}) {
    return this.searchAddon.findNext(text, options);
  }

  // Ëé∑ÂèñÈÄâ‰∏≠ÊñáÊú¨
  getSelection() {
    return this.terminal.getSelection();
  }

  // ÂÜôÂÖ•ÊñáÊú¨Âà∞ÁªàÁ´Ø
  write(text) {
    this.terminal.write(text);
  }

  // ÈîÄÊØÅÁªàÁ´Ø
  dispose() {
    if (this.isConnected) {
      window.electronAPI.terminal.kill();
    }
    this.terminal.dispose();
  }
}

// ‰ΩøÁî®Á§∫‰æã
document.addEventListener('DOMContentLoaded', () => {
  const terminal = new SimpleTerminal('terminal-container');

  // ÂÖ®Â±ÄÂºïÁî®Ôºå‰æø‰∫éË∞ÉËØï
  window.terminal = terminal;
});
```

### 5. HTML ÁïåÈù¢ (index.html)

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Terminal</title>
  <link rel="stylesheet" href="node_modules/xterm/css/xterm.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #1e1e1e;
      color: #cccccc;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      padding: 8px 16px;
      background-color: #2d2d30;
      border-bottom: 1px solid #3e3e42;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .header h1 {
      font-size: 16px;
      font-weight: normal;
    }

    .header .controls {
      display: flex;
      gap: 8px;
    }

    .btn {
      padding: 4px 12px;
      background-color: #0e639c;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }

    .btn:hover {
      background-color: #1177bb;
    }

    .btn.secondary {
      background-color: #5a5a5a;
    }

    .btn.secondary:hover {
      background-color: #6a6a6a;
    }

    #terminal-container {
      flex: 1;
      padding: 8px;
    }

    .terminal-wrapper {
      width: 100%;
      height: 100%;
      border: 1px solid #3e3e42;
      border-radius: 4px;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üñ•Ô∏è Simple Terminal</h1>
    <div class="controls">
      <button class="btn secondary" onclick="window.terminal?.clear()">Clear</button>
      <button class="btn secondary" onclick="window.terminal?.focus()">Focus</button>
      <button class="btn" onclick="createNewTerminal()">New Terminal</button>
    </div>
  </div>

  <div id="terminal-container">
    <div class="terminal-wrapper" id="terminal-wrapper"></div>
  </div>

  <script type="module" src="renderer.js"></script>
  <script>
    function createNewTerminal() {
      // ÈáçÊñ∞ÂàõÂª∫ÁªàÁ´ØÂÆû‰æã
      if (window.terminal) {
        window.terminal.dispose();
      }

      // Ê∏ÖÁ©∫ÂÆπÂô®
      const wrapper = document.getElementById('terminal-wrapper');
      wrapper.innerHTML = '';
      wrapper.id = 'terminal-container';

      // ÂàõÂª∫Êñ∞ÁªàÁ´Ø
      setTimeout(() => {
        window.terminal = new SimpleTerminal('terminal-container');
      }, 100);
    }
  </script>
</body>
</html>
```

### 6. ÊûÑÂª∫ÈÖçÁΩÆ (package.json)

```json
{
  "name": "simple-terminal",
  "version": "1.0.0",
  "description": "Simple terminal implementation with xterm.js and node-pty",
  "main": "main.js",
  "scripts": {
    "start": "electron .",
    "build": "electron-builder",
    "rebuild": "electron-rebuild"
  },
  "dependencies": {
    "electron": "^22.0.0",
    "xterm": "^5.1.0",
    "@xterm/addon-fit": "^0.7.0",
    "@xterm/addon-web-links": "^0.8.0",
    "@xterm/addon-search": "^0.12.0",
    "node-pty": "^0.10.1"
  },
  "devDependencies": {
    "electron-builder": "^24.0.0",
    "electron-rebuild": "^3.2.9"
  },
  "build": {
    "appId": "com.example.simple-terminal",
    "productName": "Simple Terminal",
    "directories": {
      "output": "dist"
    },
    "files": [
      "**/*",
      "!node_modules/node-pty/build/Release/obj/**/*"
    ]
  }
}
```

## Â¢ûÂº∫ÂäüËÉΩ

### ‰∏ªÈ¢òÊîØÊåÅ

```javascript
const themes = {
  dark: {
    background: '#1e1e1e',
    foreground: '#cccccc',
    // ... ÂÖ∂‰ªñÈ¢úËâ≤
  },
  light: {
    background: '#ffffff',
    foreground: '#000000',
    // ... ÂÖ∂‰ªñÈ¢úËâ≤
  },
  solarized: {
    background: '#002b36',
    foreground: '#839496',
    // ... ÂÖ∂‰ªñÈ¢úËâ≤
  }
};

// ÂàáÊç¢‰∏ªÈ¢ò
terminal.options.theme = themes.light;
```

### Â§öÊ†áÁ≠æÈ°µÊîØÊåÅ

```javascript
class TerminalManager {
  constructor() {
    this.terminals = new Map();
    this.activeTab = null;
  }

  createTab(id) {
    const terminal = new SimpleTerminal(`terminal-${id}`);
    this.terminals.set(id, terminal);
    return terminal;
  }

  switchTab(id) {
    if (this.activeTab) {
      this.activeTab.container.style.display = 'none';
    }

    const terminal = this.terminals.get(id);
    if (terminal) {
      terminal.container.style.display = 'block';
      terminal.focus();
      this.activeTab = terminal;
    }
  }
}
```

### ÂéÜÂè≤ÂëΩ‰ª§ÊîØÊåÅ

```javascript
class CommandHistory {
  constructor() {
    this.history = [];
    this.currentIndex = -1;
  }

  add(command) {
    this.history.push(command);
    this.currentIndex = this.history.length;
  }

  previous() {
    if (this.currentIndex > 0) {
      this.currentIndex--;
      return this.history[this.currentIndex];
    }
    return null;
  }

  next() {
    if (this.currentIndex < this.history.length - 1) {
      this.currentIndex++;
      return this.history[this.currentIndex];
    }
    return null;
  }
}
```

## ÈÉ®ÁΩ≤Ê≥®ÊÑè‰∫ãÈ°π

### Windows ÁéØÂ¢É

1. ÂÆâË£Ö Visual Studio Build Tools ÊàñÂÆåÊï¥ÁâàÊú¨
2. Êàñ‰ΩøÁî® `npm install --global windows-build-tools`
3. node-pty ÈúÄË¶ÅÊú¨Âú∞ÁºñËØë

### macOS/Linux ÁéØÂ¢É

1. Á°Æ‰øùÂÆâË£Ö‰∫Ü Python ÂíåÂü∫Êú¨ÂºÄÂèëÂ∑•ÂÖ∑
2. macOS ÈúÄË¶Å Xcode Command Line Tools
3. Linux ÈúÄË¶Å build-essential ÂåÖ

### Electron ÊâìÂåÖ

```bash
# ÈáçÂª∫ÂéüÁîüÊ®°Âùó
npm run rebuild

# ÊûÑÂª∫Â∫îÁî®
npm run build
```

## ÊÄßËÉΩ‰ºòÂåñ

1. **ÈôêÂà∂ÊªöÂä®ÁºìÂÜ≤Âå∫**: ËÆæÁΩÆÂêàÁêÜÁöÑ `scrollback` ÂÄº
2. **ÊåâÈúÄÊ∏≤Êüì**: ‰ΩøÁî® `renderer.renderRows()` ÊéßÂà∂Ê∏≤ÊüìËåÉÂõ¥
3. **ÂÜÖÂ≠òÁÆ°ÁêÜ**: ÂèäÊó∂Ê∏ÖÁêÜ‰∏ç‰ΩøÁî®ÁöÑÁªàÁ´ØÂÆû‰æã
4. **Êï∞ÊçÆËäÇÊµÅ**: ÂØπÈ´òÈ¢ëËæìÂá∫ËøõË°åËäÇÊµÅÂ§ÑÁêÜ

## ÂÆâÂÖ®ËÄÉËôë

1. **ÂëΩ‰ª§È™åËØÅ**: ÂØπÁî®Êà∑ËæìÂÖ•ËøõË°åÂü∫Êú¨È™åËØÅ
2. **ÁéØÂ¢ÉÈöîÁ¶ª**: ÈôêÂà∂ÁªàÁ´ØËøõÁ®ãÁöÑÁéØÂ¢ÉÂèòÈáè
3. **ÊùÉÈôêÊéßÂà∂**: ‰ª•ÊúÄÂ∞èÊùÉÈôêËøêË°åÁªàÁ´ØËøõÁ®ã
4. **ËæìÂá∫ËøáÊª§**: ËøáÊª§ÊΩúÂú®ÁöÑÊÅ∂ÊÑèËæìÂá∫Â∫èÂàó

## ‰∏§ÁßçÊñπÊ°àÂØπÊØî

| ÁâπÊÄß           | Á∫Ø JavaScript ÊñπÊ°à | node-pty ÊñπÊ°à     |
| -------------- | ------------------ | ----------------- |
| **ÁéØÂ¢ÉË¶ÅÊ±Ç**   | ‚úÖ Êó†ÈúÄÁºñËØëÁéØÂ¢É     | ‚ùå ÈúÄË¶Å Python/C++ |
| **ÂÆâË£ÖÁÆÄÊòìÂ∫¶** | ‚úÖ ÁÆÄÂçïÂø´ÈÄü         | ‚ùå Â§çÊùÇÔºåÂèØËÉΩÂá∫Èîô  |
| **ÊâìÂåÖ‰ΩìÁßØ**   | ‚úÖ Êõ¥Â∞è             | ‚ùå Êõ¥Â§ß            |
| **Ë∑®Âπ≥Âè∞ÂÖºÂÆπ** | ‚úÖ ËâØÂ•Ω             | ‚úÖ ÂæàÂ•Ω            |
| **ÂäüËÉΩÂÆåÊï¥Â∫¶** | ‚ö†Ô∏è Âü∫Êú¨ÂäüËÉΩ         | ‚úÖ ÂÆåÊï¥ÂäüËÉΩ        |
| **ÁªàÁ´ØÁâπÊÄß**   | ‚ö†Ô∏è ÈÉ®ÂàÜÊîØÊåÅ         | ‚úÖ ÂÆåÂÖ®ÊîØÊåÅ        |
| **ÊÄßËÉΩ**       | ‚úÖ ËâØÂ•Ω             | ‚úÖ ÂæàÂ•Ω            |

## ÂäüËÉΩÈôêÂà∂ËØ¥Êòé

### Á∫Ø JavaScript ÊñπÊ°àÈôêÂà∂

1. **Êó†Ê≥ïÂ§ÑÁêÜÂéüÁîüÁªàÁ´ØÁâπÊÄß**Ôºö
   - ‰∏çÊîØÊåÅÁúüÊ≠£ÁöÑ PTYÔºà‰º™ÁªàÁ´ØÔºâ
   - Êó†Ê≥ïÊ≠£Á°ÆÂ§ÑÁêÜ‰∏Ä‰∫õ‰∫§‰∫íÂºèÁ®ãÂ∫èÔºàÂ¶Ç `vim`„ÄÅ`nano`Ôºâ
   - ÁªàÁ´ØÂ§ßÂ∞èË∞ÉÊï¥ÂèØËÉΩ‰∏çÂÆåÊï¥

2. **ËæìÂÖ•ËæìÂá∫Â§ÑÁêÜËæÉÁÆÄÂçï**Ôºö
   - ÂèØËÉΩÊó†Ê≥ïÂÆåÁæéÂ§ÑÁêÜÊâÄÊúâ ANSI ËΩ¨‰πâÂ∫èÂàó
   - Êüê‰∫õÁâπÊÆäÊåâÈîÆÁªÑÂêàÂèØËÉΩ‰∏çÂ∑•‰Ωú
   - ÂëΩ‰ª§ÂéÜÂè≤ËÆ∞ÂΩïÈúÄË¶ÅËá™Â∑±ÂÆûÁé∞

3. **ÈÄÇÁî®Âú∫ÊôØ**Ôºö
   - ÁÆÄÂçïÂëΩ‰ª§ÊâßË°å
   - Êó•ÂøóËæìÂá∫ÊòæÁ§∫
   - ÂºÄÂèëÂ∑•ÂÖ∑ÈõÜÊàê
   - Âø´ÈÄüÂéüÂûãÂºÄÂèë

### node-pty ÊñπÊ°à‰ºòÂäø

1. **ÂÆåÊï¥ÁªàÁ´Ø‰ΩìÈ™å**Ôºö
   - ÁúüÊ≠£ÁöÑ PTY ÊîØÊåÅ
   - ÂÆåÊï¥ÁöÑ ANSI ËΩ¨‰πâÂ∫èÂàóÂ§ÑÁêÜ
   - ÊîØÊåÅÊâÄÊúâ‰∫§‰∫íÂºèÁ®ãÂ∫è

2. **Êõ¥Â•ΩÁöÑÂÖºÂÆπÊÄß**Ôºö
   - ‰∏éÁ≥ªÁªüÁªàÁ´ØË°å‰∏∫‰∏ÄËá¥
   - ÊîØÊåÅÂ§çÊùÇÁöÑÁªàÁ´ØÂ∫îÁî®
   - Êõ¥Â•ΩÁöÑÂ≠óÁ¨¶ÁºñÁ†ÅÂ§ÑÁêÜ

## Êé®Ëçê‰ΩøÁî®Âú∫ÊôØ

### ÈÄâÊã©Á∫Ø JavaScript ÊñπÊ°àÂΩìÔºö
- ‚úÖ Âè™ÈúÄË¶ÅÂü∫Êú¨ÁöÑÂëΩ‰ª§ÊâßË°åÂäüËÉΩ
- ‚úÖ Â∏åÊúõÁÆÄÂåñÈÉ®ÁΩ≤ÂíåÂàÜÂèë
- ‚úÖ ÈÅøÂÖçÁºñËØëÁéØÂ¢É‰æùËµñ
- ‚úÖ Â∫îÁî®‰ΩìÁßØÊïèÊÑü
- ‚úÖ Âø´ÈÄüÂºÄÂèëÂéüÂûã

### ÈÄâÊã© node-pty ÊñπÊ°àÂΩìÔºö
- ‚úÖ ÈúÄË¶ÅÂÆåÊï¥ÁöÑÁªàÁ´Ø‰ΩìÈ™å
- ‚úÖ Ë¶ÅÊîØÊåÅÂ§çÊùÇÁöÑ‰∫§‰∫íÂºèÁ®ãÂ∫è
- ‚úÖ ÂØπÁªàÁ´ØÂäüËÉΩË¶ÅÊ±ÇÂæàÈ´ò
- ‚úÖ ‰∏çÂú®‰πéÈÉ®ÁΩ≤Â§çÊùÇÂ∫¶
- ‚úÖ ÊúâÁ®≥ÂÆöÁöÑÊûÑÂª∫ÁéØÂ¢É

## ÊÄªÁªì

**Á∫Ø JavaScript ÊñπÊ°à**Êèê‰æõ‰∫ÜÔºö
- ‚úÖ Èõ∂‰æùËµñÁºñËØëÁéØÂ¢É
- ‚úÖ ÁÆÄÂçïÂø´ÈÄüÁöÑÈÉ®ÁΩ≤
- ‚úÖ Âü∫Êú¨‰ΩÜÂÆûÁî®ÁöÑÁªàÁ´ØÂäüËÉΩ
- ‚úÖ ËâØÂ•ΩÁöÑË∑®Âπ≥Âè∞ÂÖºÂÆπÊÄß
- ‚úÖ Êõ¥Â∞èÁöÑÂ∫îÁî®‰ΩìÁßØ

**node-pty ÊñπÊ°à**Êèê‰æõ‰∫ÜÔºö
- ‚úÖ ÂÆåÊï¥ÁöÑÁªàÁ´Ø‰ΩìÈ™å
- ‚úÖ Êõ¥Â•ΩÁöÑÁ®ãÂ∫èÂÖºÂÆπÊÄß
- ‚úÖ ‰∏ì‰∏öÁ∫ßÁöÑÂäüËÉΩÊîØÊåÅ
- ‚ùå Â§çÊùÇÁöÑÁéØÂ¢ÉË¶ÅÊ±Ç
- ‚ùå Êõ¥Â§ßÁöÑÂ∫îÁî®‰ΩìÁßØ

ÂØπ‰∫éÂ§ßÂ§öÊï∞Â∫îÁî®Âú∫ÊôØÔºå**Êé®Ëçê‰ΩøÁî®Á∫Ø JavaScript ÊñπÊ°à**ÔºåÂÆÉËÉΩÂ§üÊª°Ë∂≥ 80% ÁöÑÁªàÁ´Ø‰ΩøÁî®ÈúÄÊ±ÇÔºåÂêåÊó∂ÈÅøÂÖç‰∫ÜÁéØÂ¢É‰æùËµñÁöÑÂ§çÊùÇÊÄß„ÄÇ
